FermiSurfer
======================================

This tutorial demonstrates how to construct Hamiltonian matrix from Wannier90 output files and plot fermi surface and band structure using the FermiSurfer module.

Here class FermiSurfer is an adpation of the original FermiSurfer code, which is available at `FermiSurfer Web page <https://mitsuaki1987.github.io/fermisurfer/>`_.

Prerequisites
-------------

Required Wannier90 output files:

* `wannier90_hr.dat` - Hamiltonian matrix in real space
* `wannier90.wout` - Wannier90 output file
* `fermi_energy` - from QE or VASP nscf output file

Construct Hamiltonian Matrix
-------------------------------

Load the Wannier90 Hamiltonian matrix, crystal structure and Fermi energy:

.. code-block:: matlab

   % seedname_hr.dat contains the Hamiltonian matrix in real space
   % seedname.wout is the Wannier90 output file, contains crystal structure
   % prefix.xml provides the Fermi energy
   w=WAN('examples/MgB2/MgB2_hr.dat','examples/MgB2/MgB2.wout');
   [~, w.fermi_energy_ev]=BANDS.readfermienergy('examples/MgB2/MgB2.xml');

Plot Band Structure
-----------------------

Plot the band structure along high-symmetry paths:

.. code-block:: matlab

   % read high-symmetry k-points path from KPATH.in
   % which is generated by vaspkit
   [kpath,kpathlabel]=VASP.readKPATHin('examples/MgB2/KPATH.in');
   hlines=w.plotband(kpath, kpathlabel);

   for i=1:size(hlines,1)
       hlines(i).LineWidth=1.5;
   end
   set(gca,'FontSize',12);

.. figure:: /_static/images/MgB2_wan_band.png
   :alt: MgB₂ band structure
   :width: 400px
   :align: center

   Band structure

Plot Fermi Surface
-------------------------

.. code-block:: matlab

   % export *.frmsf file readable by FermiSurfer
   w.exportfermisurfer('MgB2_vfermi.frmsf');
   % plot fermi surface, colorbar shows Fermi velocity
   figure;
   f=FermiSurfer('MgB2_vfermi.frmsf');
   f.plot
   colorbar

.. figure:: /_static/images/MgB2_vfermi.png
   :alt: MgB₂ fermi surface
   :width: 400px
   :align: center

   Fermi velocity

.. Advanced Features
.. -----------------

.. Project band structure onto specific orbitals:
